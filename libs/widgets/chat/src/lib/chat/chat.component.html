<lib-widget [host]="host()">
  <main #chatwindow>
    @for (message of filteredMessages(); track message.timestamp) {
      <div class="message {{ message.role }}" [innerHTML]="message.content | markdown"></div>
    }
  </main>
  <footer>
    <form (submit)="sendMessage($event)" #form>
      <label for="prompt">
        <textarea
          id="prompt"
          [placeholder]="'Enter to send, Shift + Enter to wrap'"
          [formControl]="userPrompt"
          (keypress)="maybeSendMessage($event)"
        ></textarea>
        <button type="submit" [disabled]="!userPrompt.getRawValue()">
          <span class="material-symbols-outlined">send</span>
          <span>Send</span>
        </button>
      </label>
      <small class="progress">{{ progressText() }}</small>
    </form>
  </footer>
</lib-widget>
